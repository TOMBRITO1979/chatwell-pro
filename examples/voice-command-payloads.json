{
  "description": "Exemplos de payloads para testar a API de comandos de voz",
  "base_url": "https://app.chatwell.pro",
  "authentication": {
    "header": "X-API-Key",
    "value": "SUBSTITUA_COM_SUA_API_KEY"
  },
  "examples": {
    "eventos": [
      {
        "name": "ReuniÃ£o bÃ¡sica",
        "payload": {
          "transcription": "Agendar reuniÃ£o com cliente amanhÃ£ Ã s 15 horas",
          "type": "auto",
          "source": "telegram",
          "metadata": {
            "chat_id": "123456789",
            "message_id": "999"
          }
        },
        "expected_result": "Evento criado para amanhÃ£ Ã s 15h"
      },
      {
        "name": "Consulta com hora especÃ­fica",
        "payload": {
          "transcription": "Marcar consulta dia 25 Ã s 10h30",
          "type": "event",
          "source": "whatsapp"
        },
        "expected_result": "Evento dia 25 Ã s 10h30"
      },
      {
        "name": "Evento hoje",
        "payload": {
          "transcription": "Compromisso hoje Ã s 14h no escritÃ³rio",
          "type": "auto",
          "source": "telegram"
        },
        "expected_result": "Evento hoje Ã s 14h com localizaÃ§Ã£o 'escritÃ³rio'"
      },
      {
        "name": "ReuniÃ£o online",
        "payload": {
          "transcription": "ReuniÃ£o online na prÃ³xima segunda Ã s 9h",
          "type": "event",
          "source": "telegram"
        },
        "expected_result": "Evento online com link Jitsi gerado automaticamente"
      },
      {
        "name": "Call especÃ­fico",
        "payload": {
          "transcription": "Call com fornecedor dia 20 de novembro Ã s 16h",
          "type": "auto",
          "source": "whatsapp"
        },
        "expected_result": "Evento tipo 'call' dia 20/11 Ã s 16h"
      },
      {
        "name": "Evento com duraÃ§Ã£o",
        "payload": {
          "transcription": "ReuniÃ£o amanhÃ£ Ã s 9h por 2 horas",
          "type": "event",
          "source": "telegram"
        },
        "expected_result": "Evento de 9h Ã s 11h"
      }
    ],
    "contas": [
      {
        "name": "Conta de energia",
        "payload": {
          "transcription": "Conta de energia vence dia 25 no valor de 350 reais",
          "type": "auto",
          "source": "telegram"
        },
        "expected_result": "Conta a pagar R$ 350,00 categoria 'Energia'"
      },
      {
        "name": "Boleto internet",
        "payload": {
          "transcription": "Pagar boleto de internet dia 15 de 120 reais",
          "type": "account",
          "source": "whatsapp"
        },
        "expected_result": "Conta a pagar R$ 120,00 categoria 'Internet'"
      },
      {
        "name": "Conta a receber",
        "payload": {
          "transcription": "Receber pagamento do cliente dia 30 de 5000 reais",
          "type": "auto",
          "source": "telegram"
        },
        "expected_result": "Conta a RECEBER R$ 5.000,00"
      },
      {
        "name": "Fatura cartÃ£o",
        "payload": {
          "transcription": "Fatura do cartÃ£o vence dia 10 valor 2500",
          "type": "account",
          "source": "telegram"
        },
        "expected_result": "Conta a pagar R$ 2.500,00"
      },
      {
        "name": "Conta com centavos",
        "payload": {
          "transcription": "Conta de Ã¡gua para o dia 5 no valor de 85 reais e 50 centavos",
          "type": "auto",
          "source": "whatsapp"
        },
        "expected_result": "Conta a pagar R$ 85,50 categoria 'Ãgua'"
      },
      {
        "name": "Aluguel",
        "payload": {
          "transcription": "Pagar aluguel dia 5 de R$ 1800",
          "type": "account",
          "source": "telegram"
        },
        "expected_result": "Conta a pagar R$ 1.800,00 categoria 'Aluguel'"
      }
    ],
    "edge_cases": [
      {
        "name": "Sem data (deve falhar)",
        "payload": {
          "transcription": "Agendar reuniÃ£o com cliente",
          "type": "auto",
          "source": "test"
        },
        "expected_result": "Erro: data/hora nÃ£o identificada"
      },
      {
        "name": "Sem valor (deve falhar)",
        "payload": {
          "transcription": "Conta de luz vence amanhÃ£",
          "type": "auto",
          "source": "test"
        },
        "expected_result": "Erro: valor nÃ£o identificado"
      },
      {
        "name": "Comando ambÃ­guo",
        "payload": {
          "transcription": "Lembrar de fazer algo importante",
          "type": "auto",
          "source": "test"
        },
        "expected_result": "Erro: nÃ£o conseguiu identificar tipo"
      },
      {
        "name": "TranscriÃ§Ã£o vazia",
        "payload": {
          "transcription": "",
          "type": "auto",
          "source": "test"
        },
        "expected_result": "Erro: transcriÃ§Ã£o obrigatÃ³ria"
      }
    ],
    "advanced": [
      {
        "name": "Evento com mÃºltiplos detalhes",
        "payload": {
          "transcription": "Agendar reuniÃ£o online com o cliente JoÃ£o da empresa XYZ para discutir o projeto amanhÃ£ Ã s 15 horas",
          "type": "event",
          "source": "telegram",
          "metadata": {
            "audio_duration": 12,
            "chat_id": "123456789"
          }
        },
        "expected_result": "Evento online criado com tÃ­tulo extraÃ­do"
      },
      {
        "name": "Conta com descriÃ§Ã£o longa",
        "payload": {
          "transcription": "Preciso pagar a conta de internet da NET que vence no dia 15 do prÃ³ximo mÃªs no valor de 120 reais",
          "type": "account",
          "source": "whatsapp"
        },
        "expected_result": "Conta criada com tÃ­tulo 'Conta de internet da NET'"
      },
      {
        "name": "Data complexa",
        "payload": {
          "transcription": "ReuniÃ£o dia 15 de dezembro Ã s 9 da manhÃ£",
          "type": "event",
          "source": "telegram"
        },
        "expected_result": "Evento dia 15/12 Ã s 09h"
      }
    ]
  },
  "curl_examples": {
    "criar_evento": {
      "command": "curl -X POST https://app.chatwell.pro/api/webhooks/voice-commands -H \"Content-Type: application/json\" -H \"X-API-Key: SUA_API_KEY\" -d '{\"transcription\": \"Agendar reuniÃ£o com cliente amanhÃ£ Ã s 15 horas\", \"type\": \"auto\", \"source\": \"telegram\"}'",
      "description": "Criar evento via comando de voz"
    },
    "criar_conta": {
      "command": "curl -X POST https://app.chatwell.pro/api/webhooks/voice-commands -H \"Content-Type: application/json\" -H \"X-API-Key: SUA_API_KEY\" -d '{\"transcription\": \"Conta de energia vence dia 25 no valor de 350 reais\", \"type\": \"auto\", \"source\": \"telegram\"}'",
      "description": "Criar conta via comando de voz"
    },
    "get_info": {
      "command": "curl -X GET https://app.chatwell.pro/api/webhooks/voice-commands",
      "description": "Obter informaÃ§Ãµes sobre a API"
    },
    "obter_api_key": {
      "command": "curl -X GET https://app.chatwell.pro/api/user/api-key -H \"Authorization: Bearer SEU_JWT_TOKEN\"",
      "description": "Obter API Key do usuÃ¡rio logado"
    },
    "gerar_api_key": {
      "command": "curl -X POST https://app.chatwell.pro/api/user/api-key -H \"Authorization: Bearer SEU_JWT_TOKEN\"",
      "description": "Gerar nova API Key"
    }
  },
  "n8n_workflow_example": {
    "description": "Exemplo de configuraÃ§Ã£o do body no node HTTP Request do n8n",
    "body": {
      "transcription": "={{ $json.text }}",
      "type": "auto",
      "source": "telegram",
      "metadata": {
        "chat_id": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "message_id": "={{ $('Telegram Trigger').item.json.message.message_id }}",
        "timestamp": "={{ $('Telegram Trigger').item.json.message.date }}",
        "audio_duration": "={{ $('Telegram Trigger').item.json.message.voice.duration }}",
        "audio_url": "URL do Ã¡udio (opcional)"
      }
    }
  },
  "response_examples": {
    "success_event": {
      "success": true,
      "type": "event",
      "data": {
        "id": "abc-123-def-456",
        "title": "ReuniÃ£o com cliente",
        "start_time": "2025-10-19T15:00:00Z",
        "end_time": "2025-10-19T16:00:00Z",
        "location": null,
        "event_type": "meeting",
        "created_at": "2025-10-18T10:30:00Z"
      },
      "message": "âœ… Evento agendado com sucesso!\n\nðŸ“… ReuniÃ£o com cliente\nðŸ•’ sÃ¡bado, 19 de outubro, 15:00\n\nID: abc-123-def-456",
      "parsed_info": {
        "title": "ReuniÃ£o com cliente",
        "date": "19/10/2025",
        "time": "15:00",
        "location": null,
        "event_type": "meeting"
      }
    },
    "success_account": {
      "success": true,
      "type": "account",
      "data": {
        "id": "xyz-789-uvw-012",
        "title": "Conta de energia",
        "amount": "350.00",
        "due_date": "2025-10-25",
        "type": "expense",
        "status": "pending",
        "category": "Energia",
        "created_at": "2025-10-18T10:30:00Z"
      },
      "message": "âœ… Conta a pagar cadastrada com sucesso!\n\nðŸ’¸ Conta de energia\nðŸ’µ R$ 350.00\nðŸ“… Vencimento: 25 de outubro de 2025\nðŸ·ï¸ Categoria: Energia\n\nID: xyz-789-uvw-012",
      "parsed_info": {
        "title": "Conta de energia",
        "amount": "R$ 350.00",
        "due_date": "25/10/2025",
        "type": "a pagar",
        "category": "Energia"
      }
    },
    "error_no_date": {
      "success": false,
      "message": "NÃ£o consegui identificar a data/hora. Tente falar algo como 'amanhÃ£ Ã s 15 horas' ou 'dia 25 Ã s 10h'.",
      "transcription": "agendar reuniÃ£o com cliente",
      "suggestion": "Tente falar algo como: \"Agendar reuniÃ£o com cliente amanhÃ£ Ã s 15 horas\" ou \"Conta de energia vence dia 25 no valor de 350 reais\""
    },
    "error_invalid_api_key": {
      "success": false,
      "message": "API Key invÃ¡lida ou usuÃ¡rio inativo."
    }
  },
  "testing": {
    "bash_script": "./test-voice-commands.sh",
    "manual_test": {
      "step_1": "export API_KEY='sua-api-key-aqui'",
      "step_2": "curl -X POST https://app.chatwell.pro/api/webhooks/voice-commands -H \"Content-Type: application/json\" -H \"X-API-Key: $API_KEY\" -d '{\"transcription\": \"Agendar reuniÃ£o com cliente amanhÃ£ Ã s 15 horas\", \"type\": \"auto\", \"source\": \"test\"}'"
    },
    "sql_queries": {
      "ver_logs": "SELECT * FROM voice_command_logs ORDER BY created_at DESC LIMIT 10;",
      "ver_eventos_criados": "SELECT e.*, vcl.transcription FROM events e JOIN voice_command_logs vcl ON e.id::text = vcl.created_item_id::text WHERE vcl.created_at > NOW() - INTERVAL '1 day';",
      "ver_contas_criadas": "SELECT a.*, vcl.transcription FROM accounts a JOIN voice_command_logs vcl ON a.id::text = vcl.created_item_id::text WHERE vcl.created_at > NOW() - INTERVAL '1 day';",
      "taxa_sucesso": "SELECT COUNT(*) FILTER (WHERE created_item_id IS NOT NULL) * 100.0 / COUNT(*) as success_rate FROM voice_command_logs WHERE created_at > NOW() - INTERVAL '7 days';"
    }
  }
}
